Bootstrap: docker

From: nvidia/cuda:11.3.1-devel-ubuntu20.04

%post

    # Prevent tzdata from blocking installation
    export DEBIAN_FRONTEND=noninteractive
    
    # Update package lists
    apt-get update

    # Install system dependencies and Python 3.9
    apt-get install -y python3.9 python3.9-venv python3.9-dev git wget python3-pip nano

    # Upgrade pip
    python3.9 -m pip install --upgrade pip

    # Clone DPDM
    mkdir -p workspace
    git clone https://github.com/nv-tlabs/DPDM.git workspace/DPDM
    cd workspace/DPDM

    # Install dependencies from DPDM's requirements.txt
    python3.9 -m pip install -r requirements.txt

    # Install click
    python3.9 -m pip install click

%environment
    # Fix terminal for interactive use
    export TERM=xterm
